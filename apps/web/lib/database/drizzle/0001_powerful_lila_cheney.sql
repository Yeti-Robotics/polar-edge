DROP VIEW IF EXISTS "public"."team_stats";--> statement-breakpoint
ALTER TABLE "team" ALTER COLUMN "team_number" SET DATA TYPE integer;--> statement-breakpoint
ALTER TABLE "stand_form" DROP COLUMN "teleop_algae_thrown";--> statement-breakpoint
CREATE VIEW "public"."team_match_stats" AS (select "team_number", "match_id", avg("auto_coral_level1") as "auto_coral_level_1", avg("auto_coral_level2") as "auto_coral_level_2", avg("auto_coral_level3") as "auto_coral_level_3", avg("auto_coral_level4") as "auto_coral_level_4", avg("auto_algae_processed") as "auto_algae_processor", avg("auto_algae_netted") as "auto_algae_net", avg("teleop_coral_level1") as "teleop_coral_level_1", avg("teleop_coral_level2") as "teleop_coral_level_2", avg("teleop_coral_level3") as "teleop_coral_level_3", avg("teleop_coral_level4") as "teleop_coral_level_4", avg("teleop_algae_processed") as "teleop_algae_processor", avg("teleop_algae_netted") as "teleop_algae_net", AVG(CASE WHEN "cage_climb" = 'Parked' THEN 1 ELSE 0 END) as "park_percentage", AVG(CASE WHEN "cage_climb" = 'ShallowCage' THEN 1 ELSE 0 END) as "shallow_percentage", AVG(CASE WHEN "cage_climb" = 'DeepCage' THEN 1 ELSE 0 END) as "deep_percentage", avg("defense_rating") as "defense_rating", AVG(CAST("left_black_line" AS INT)) as "initiation_line" from "stand_form" group by "stand_form"."team_number", "stand_form"."match_id");